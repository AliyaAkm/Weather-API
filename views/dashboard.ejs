<%- include('partials/header') %>

<h2 id="welcomeMessage">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!</h2>

<p>–í—ã —É—Å–ø–µ—à–Ω–æ –≤–æ—à–ª–∏ –≤ —Å–∏—Å—Ç–µ–º—É.</p>

<div>
    <input type="text" id="locationInput" placeholder="–í–≤–µ–¥–∏—Ç–µ –ª–æ–∫–∞—Ü–∏—é..." />
    <button id="searchLocation">üåç –ü–æ–∏—Å–∫ –ø–æ–≥–æ–¥—ã</button>
</div>

<a href="#" class="logout-btn" id="logout">üö™ –í—ã–π—Ç–∏</a>

<script>
    document.addEventListener("DOMContentLoaded", async function () {
        const token = localStorage.getItem("token");
        if (!token) {
            window.location.href = "/login";
            return;
        }

        try {
            const response = await fetch("/protected/dashboard", {
                method: "GET",
                headers: { "Authorization": `Bearer ${token}` }
            });

            if (!response.ok) {
                throw new Error("–¢–æ–∫–µ–Ω –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω");
            }

            const data = await response.json();
            document.getElementById("welcomeMessage").innerText = `–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, ${data.message}`;
        } catch (error) {
            localStorage.removeItem("token");
            window.location.href = "/login";
        }
    });
</script>

<%- include('partials/footer') %>
